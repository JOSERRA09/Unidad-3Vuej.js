<!DOCTYPE html> 
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplicación</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
</head>
<body>

<div id="movil">
    <h1>WELCOME A</h1>
    <img src="RS.png" alt="img" width="150" height="150">

    <form @submit.prevent="login">
        <input type="text" v-model="username" placeholder="Usuario" required>
        <input type="password" v-model="password" placeholder="Contraseña" required>
        <button type="submit">SKIP</button>
    </form>

    <p v-if="error">{{ error }}</p>

    <div v-if="isLoggedIn">
        
        <h2>USUARIOS</h2>
        <img src="Stars.png" alt="img" width="150" height="150">
        
        <img src="R.P.D.png" alt="img" width="150" height="150">

        <img src="Simbolo.png" alt="img" width="150" height="150">
        
        <table>
            <thead>
                <tr>
                    <th>
                        Usuario

                    </th>

                    <th>
                        Contraseña

                    </th>

                    <th>
                        Contacto

                    </th>

                    <th>
                        Compañia

                    </th>

                    <th>
                        Dirección

                    </th>

                    <th>
                        Suite

                    </th>

                    <th>
                        Calle

                    </th>

                    <th>
                        Ciudad

                    </th>

                    <th>
                        Acciones

                    </th>
                </tr>

            </thead>

            <tbody>

                <tr v-for="(user, index) in users" :key="user.username">
                    <td>
                        {{ user.username }}

                    </td>
                    <td>
                        {{ user.password }}

                    </td>

                    <td>
                        {{ user.Contacto }}

                    </td>

                    <td>
                        {{ user.compañia }}

                    </td>

                    <td>{{ user.direccion }}

                    </td>

                    <td>
                        {{ user.suite }}

                    </td>

                    <td>
                        {{ user.calle }}

                    </td>

                    <td>
                        {{ user.ciudad }}

                    </td>
                    <td>
                        <button @click="Eliminarusuario(index)">Eliminar</button> 
                    </td>
                </tr>

            </tbody>

        </table>
  
    </div>

</div>

<script>
    const app = Vue.createApp({
        data() {
            return {
                username: '',
                password: '',
                error: '',
                users: [],
                isLoggedIn: false
            };
        },
        methods: {
            async login() {
                try {
                    const response = await fetch('usuarios.json');
                    const users = await response.json();

                    const user = users.find(user => 
                        user.username === this.username && user.password === this.password
                    );


                    if (user) {

                        sessionStorage.setItem('loggedUser', JSON.stringify(user));
                        this.users = users; 
                        this.isLoggedIn = true; 
                        this.error = '';
                        alert('BIENVENIDO A RACCON CITY');
                    } else {
                        this.error = 'INCORRECTO';
                    }
                } catch (err) {
                    console.error('ERROR NO CARGA USUARIO:', err);

                    this.error = 'NO CARGA EL SISTEMA';
                }
            },

            deleteUser(index) {
                this.users.splice(index, 1); 
            }
        },
        mounted() {
            const loggedUser = sessionStorage.getItem('loggedUser');
            if (loggedUser) {
                this.isLoggedIn = true;
                this.users = JSON.parse(loggedUser);
            }
        }
    });

    app.mount('#movil');
</script>

<style>
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    th, td {
        border: 1px solid #000000;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #000000;
    }
</style>

</body>
</html>
